DECLARE @CurrentMigration [nvarchar](max)

IF object_id('[dbo].[__MigrationHistory]') IS NOT NULL
    SELECT @CurrentMigration =
        (SELECT TOP (1) 
        [Project1].[MigrationId] AS [MigrationId]
        FROM ( SELECT 
        [Extent1].[MigrationId] AS [MigrationId]
        FROM [dbo].[__MigrationHistory] AS [Extent1]
        WHERE [Extent1].[ContextKey] = N'Site.Repositorio.DBProduto'
        )  AS [Project1]
        ORDER BY [Project1].[MigrationId] DESC)

IF @CurrentMigration IS NULL
    SET @CurrentMigration = '0'

IF @CurrentMigration < '201709031604073_InitialCreate'
BEGIN
    CREATE TABLE [dbo].[ProdutoModels] (
        [Id] [int] NOT NULL IDENTITY,
        [Nome] [nvarchar](max),
        [Preco] [decimal](18, 2) NOT NULL,
        CONSTRAINT [PK_dbo.ProdutoModels] PRIMARY KEY ([Id])
    )
    CREATE TABLE [dbo].[__MigrationHistory] (
        [MigrationId] [nvarchar](150) NOT NULL,
        [ContextKey] [nvarchar](300) NOT NULL,
        [Model] [varbinary](max) NOT NULL,
        [ProductVersion] [nvarchar](32) NOT NULL,
        CONSTRAINT [PK_dbo.__MigrationHistory] PRIMARY KEY ([MigrationId], [ContextKey])
    )
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201709031604073_InitialCreate', N'Site.Repositorio.DBProduto',  0x1F8B0800000000000400CD57C96E233710BD07C83F103C258047F4729918AD1978243B3032B20DB767EE54774926C2A543B20DE9DB72C827E5175254AF626BB1078341A08B9A5DF56A7B55C5FEF7EF7F928F2B25C90B58278C1ED3B3D12925A033930BBD1CD3D22FDEBDA71F3FFCFC53729DAB15F9DAC85D0439D4D46E4C9FBD2F2E1973D93328EE464A64D638B3F0A3CC28C673C3CE4F4F7F6367670C1082221621C963A9BD50B079C0C789D11914BEE472667290AE3EC737E90695DC7105AEE0198C692A3C8C1EA1304E786385A1E44A0A8E7EA420179470AD8DE71EBDBCFCE220F5D6E8655AE001974FEB02506EC1A583DAFBCB4EFCB5819C9E874058A7D84065A5F346BD11F0ECA2CE0C8BD5BF29BFB4CD1CE6EE1A73ECD721EA4DFEC6F4C19ABCF4A6CA3125B1C5CB89B441BACE712536DA523A21E1D5494B04E44BF89D9049297D6961ACA1F496CB13F250CEA5C8FE80F593F913F4589752F69D43F7F0DDD6011EA1AD02AC5F3FC2A276F936A7846DEBB158B155EBE95471DC6A7F714EC91D1AE773096DED7B31A74822F81D3458EE217FE0DE83D5010336D91B588F6CDD19058D35241B760D2533BEFA0C7AE99FC714FF52722356903727B5075FB4C02643256F4B3866E4C142661A2B53C884E29292702AEAB67D4F499AF110E1AE70FBE809EB6831240B36A2E70293515B9E7EAACBBF832DD85E35615C1DC6761015620A7E9B7D48BCCE83AA6B47113177F9DB7AD6CD06560D876688B03D532499F1A2C0C2F4A64A7D42D26AA44CDEA56FEF365561B0CCED68BAD6DBD612D28C2F217A8BA6D1D31B619D9F72CFE73C546B92AB815857873D396EEC44A98E1BACCB7CA310FE574AF1608DAA12417559BCC1C01476CB2646683D8AC7CD407F33DDB9E47647FB4E8C2C95DE37020E69570DD9D7AF4E5E8F50775B1FA23E1A62242C4A429C7036C87834CCE20A1EA27E2CD25A6F5B20A27A52D3EEF8561DF0B0120953C6BC883C70305D3B0F6A140446E95F722205C6DB09CCB8160B70BE9AF71457DB79B49AFF3F6B923997CBB7ECCA1FBEB94448EDD1DD7470D21F5E56FA85DBEC99DB5F145FFDDA477AF342CA7FE4421ACECB572D9D66B31CDB3C15EB31A67908AFF2F9FB2CA7612726AC7F0B4EA6E0C4B2830877620D59A07807DAC8DCEA85694A82B1F63D6A44A28ACDC0F31C537665BD58F0CCE3EB0C9CDBDC57BE7259A2C8B59A437EABEF4B5F94FECA395073B975FF49D861FB9B0DBCED73725F8427F73D424037058600F7FA532964DEFA7DB383537B20027BEA7E42AFF0BE8670CB758B7467F42B81EAF44DA1001DBAF109542111CCDDEB94BFC0B7F886D7A9CFB0E4D9BA19A8FB418E17623BEDC954F0A5E5CAD5189D7EF8B263E1D3EEC37FE3B3B90B0C0E0000 , N'6.1.3-40302')
END

IF @CurrentMigration < '201709031723299_testMigration'
BEGIN
    ALTER TABLE [dbo].[ProdutoModels] ADD [Categoria] [nvarchar](max)
    INSERT [dbo].[__MigrationHistory]([MigrationId], [ContextKey], [Model], [ProductVersion])
    VALUES (N'201709031723299_testMigration', N'Site.Repositorio.DBProduto',  0x1F8B0800000000000400CD57DB6E1B37107D2FD07F20F8D4028EE8CB4B6AAC1238925D188D6CC3EBE49DDA1DC94479D9925C43FAB63EF493FA0B1D6AAFA2244B0ADC20D08B7676E6CC857366B8FFFEFD4FF271A1247901EB84D1437A3638A504746672A1E7435AFAD9BBF7F4E3879F7F4AAE73B5205F1BBD8BA08796DA0DE9B3F7C525632E7B06C5DD4089CC1A67667E9019C5786ED8F9E9E96FECEC8C014250C42224792CB5170A560FF838323A83C2975C4E4C0ED2D5727C93AE50C91D57E00A9EC190A6C2C3E0110AE3843756184AAEA4E018470A724609D7DA78EE31CACB2F0E526F8D9EA7050AB87C5A16807A332E1DD4D15F76EA8726727A1E12619D61039595CE1B7524E0D9455D19169B7F537D695B39ACDD35D6D82F43D6ABFA0DE9833579E94D55634A628F97236983765DE34A6DB0667442C2AB93B611B05FC2EF848C4AE94B0B430DA5B75C9E9087722A45F6072C9FCC9FA087BA94B21F1C8687EFD60428425F0558BF7C84591DF26D4E095BB763B1616BD6B3A9F2B8D5FEE29C923B74CEA712DAB3EFE59C6213C1EFA0C1720FF903F71EAC0E18B0AADE86F7C8D79D51D078C36643D65032E18BCFA0E7FE7948F12F253762017923A923F8A205920C8DBC2D619F93070B9969BC8C21138A4B4A8254D4B47D4F499AF190E1B6745F471F61E27364127FE33C12D635E0665B22E53D1758F63A8AF1A7BAD1B6F42512B96E4D573B5A4FA8424CC1AFF739B6781741351F061105B6C5DB46D64D21568DA1665CB11DF32A99F0A2C0D2F5E6572D216935BC46EFD2E379AD2A0C96B92DF46EA36D3D6143F339446FD135467A23ACF363EEF99487C31BE56A43AD3B871D356EFC44A58EA9DC55BE3108FF2BA3788447A712417555BCC1C414F2729523B411C5836DC37EB547B8E476CBA01819592ABD6BD8BC665D51BF6F5F490E47A879DD87A8458763F4D8DBC7E98937B1121615343E3CB6717AD1088EBBE1351AC52AADF7964E116D92BA85F7DF05367ABA5209B3D1BC883CF473BA741ED420280CD2BFE4480ACCB75398702D66E07CB5A5282EE4F3E842F1E32C77E65C2E8FD9F0DF7DDF8A50DABD1BF5C8FDD45FB1FA85DBEC99DB5F145FFCDA473A7A8DE6FFFB1A3D22D6E356E5E6243F681D363B6FDF4EAC3884159A86625521BFCDDADCE475C2FA5F02C9189C987710E1BB40431608D381363AB77A669A23C05CFB11352AD1094DC0F31C4B7665BD98F1CCE3EB0C9C5BDD75BE7259A2CAB59A427EABEF4B5F94FECA395053B976074CD8EBFE577783F59893FB223CB9B74801C3149802DCEB4FA590791BF7CD6687EE8208DD53B313A3C2BB5EE8DB658B7467F4814075F9C650800EDC7E0255480473F73AE52FF02DB1E145EF33CC79B66CC6F36E90FD07B15EF6642CF8DC72E56A8CCE3E7CDDB2F079FBE13F058B436D100F0000 , N'6.1.3-40302')
END

